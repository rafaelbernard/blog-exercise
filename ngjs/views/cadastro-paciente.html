<div data-ng-include data-src="'views/includes/_menu.v1.html'"></div>

<div id="content" class="container container_principal container_mensagens" data-ng-init="cadastroController._init()">

    <div class="row area_cadastro_geral">

        <!-- COLUNA ESQUERDA -->
        <div class="col-xs-12 col-sm-3">
            <img class="icon_cadastro_paciente hidden-xs" src="../images/img_icone_cadastro_pacientes.png" alt=""/>
            <h1 class="tit_page_cadastro_paciente">Cadastro de Pacientes</h1>
            <ul class="etapa_cadastro_pacientes">
                <li ng-class="cadastroController.formCadastro.fase1 ? 'active' : 'inactive'">ETAPA 01</li>
                <li ng-class="!cadastroController.formCadastro.fase1 ? 'active' : 'inactive'">ETAPA 02</li>
            </ul>
            <button class="btn_cadastro_avancar radius" data-ng-click="cadastroController._init()"
                    data-ng-show="cadastroController.formCadastro.cpf && cadastroController.formCadastro.viewDataNascConsumidor">
                Limpar formulário
            </button>
        </div>

        <!-- COLUNA DIREITA -->
        <div class="col-xs-12 col-sm-9 no-pad">

            <div class="col-xs-12">
                <hr class="separador_cadastro1"/>
            </div>

            <div class="col-xs-12 no-pad" id="div-inicio-cadastro">
                <div data-ng-class="cadastroController.formCadastro.fase1 ? 'fase-ativa' : 'fase-inativa'">
                    <form name="formularioCadastro">
                        <div class="col-xs-12 col-sm-4">
                            <label class="label_cadastro">CPF
                                <input class="input_cadastro" type="text" name="cpf" required autofocus
                                       placeholder="CPF" data-ui-mask-placeholder data-ui-mask="999.999.999-99"
                                       data-ng-readonly="cadastroController.formCadastro.fase2"
                                       data-ng-model="cadastroController.formCadastro.cpf">
                            </label>
                        </div>

                        <div class="col-xs-12 col-sm-4">
                            <label class="label_cadastro">DATA DE NASCIMENTO
                                <input class="input_cadastro" type="text" name="dataNascConsumidor"
                                       placeholder="Data de Nascimento" required data-ui-mask-placeholder
                                       data-ui-mask="99/99/9999"
                                       data-ng-readonly="cadastroController.formCadastro.fase2"
                                       data-ng-model="cadastroController.formCadastro.viewDataNascConsumidor"/>
                            </label>
                        </div>

                        <div class="col-xs-12 col-sm-4">
                            <button class="btn_cadastro_avancar radius"
                                    data-ng-disabled="cadastroController.requestInProgress"
                                    data-ng-click="cadastroController.cadastroFaseUmV2()">Avançar
                            </button>
                        </div>

                    </form>

                </div>

            </div>

            <div class="col-xs-12 xalert-info" data-ng-show="cadastroController.requestInProgressBuscaCPF">
                Verificando cadastro do CPF
                <md-progress-linear md-mode="indeterminate"></md-progress-linear>
            </div>

            <div ng-show="cadastroController.formCadastro.fase2" class="col-xs-12">
                <hr class="separador_cadastro2 "/>
            </div>

            <div class="col-xs-12 no-pad">

                <div data-ng-show="cadastroController.formCadastro.fase2">
                    <form id="cadastroStep2" name="formCadastroConclusao" novalidate>

                        <div class="col-xs-12 col-sm-4">
                            <label class="label_cadastro">NOME
                                <input class="input_cadastro" maxlength="40" type="text" name="nome"
                                       placeholder="Ex: Pedro" required
                                       data-ng-model="cadastroController.formCadastro.NomeConsumidor">
                            </label>
                        </div>

                        <div class="col-xs-12 col-sm-5">
                            <label class="label_cadastro">SOBRENOME
                                <input class="input_cadastro" maxlength="40" type="text" name="sobrenome"
                                       placeholder="Ex: Gonzaga" required
                                       data-ng-model="cadastroController.formCadastro.SobrenomeConsumidor">
                            </label>
                        </div>

                        <div class="col-xs-12 col-sm-3">
                            <label class="label_cadastro">GÊNERO
                                <div class="wrap_form">
                                    <select name="sexo" required
                                            data-ng-model="cadastroController.formCadastro.genero">
                                        <option value="">Gênero</option>
                                        <option value="M">Masculino</option>
                                        <option value="F">Feminino</option>
                                        <option value="P">Personalizado</option>
                                    </select>

                                </div>
                            </label>
                        </div>

                        <div class="col-xs-12" ng-if="cadastroController.formCadastro.genero == 'P'">
                            <label class="label_cadastro">PERSONALIZADO
                                <input class="input_cadastro" maxlength="50" type="text" name="generoPersonalizado"
                                       placeholder="DIGITE O GÊNERO"
                                       data-ng-model="cadastroController.formCadastro.generoPersonalizado">
                            </label>
                        </div>

                        <div class="col-xs-12 col-sm-4">
                            <label class="label_cadastro">CELULAR
                                <div class="row row_input">
                                    <div class="col-xs-3 col-sm-4 col_input_ddd">
                                        <input type="text" name="DDDCelular"
                                               class="input_ddd ddd_celular input_cadastro" placeholder="DDD"
                                               data-ng-required="cadastroController.formCadastro.FoneCelular"
                                               data-ui-mask-placeholder data-ui-mask="99"
                                               data-ui-mask-placeholder-char="space"
                                               data-ng-model="cadastroController.formCadastro.DDDCelular">
                                    </div>
                                    <div class="col-xs-9 col-sm-8 col_input_phone">
                                        <input class="numero_celular input_cadastro" type="text" name="FoneCelular"
                                               placeholder="Telefone Celular"
                                               data-ng-required="!cadastroController.formCadastro.telefoneFixo"
                                               data-ui-mask-placeholder data-ui-mask="99999999?9"
                                               data-ui-mask-placeholder-char="space"
                                               data-ng-model="cadastroController.formCadastro.FoneCelular">
                                    </div>
                                </div>
                            </label>
                        </div>

                        <div class="col-xs-12 col-sm-4">
                            <label class="label_cadastro">TELEFONE FIXO
                                <div class="row row_input">
                                    <div class="col-xs-3 col-sm-4 col_input_ddd">
                                        <input class="input_cadastro input_ddd ddd_residencial" type="text" name="dddTelefoneFixo"
                                               placeholder="DDD"
                                               data-ng-required="cadastroController.formCadastro.telefoneFixo"
                                               data-ui-mask-placeholder data-ui-mask="99"
                                               data-ui-mask-placeholder-char="space"
                                               data-ng-model="cadastroController.formCadastro.dddTelefoneFixo">
                                    </div>
                                    <div class="col-xs-9 col-sm-8 col_input_phone">
                                        <input name="telefoneFixo" class="input_cadastro numero_residencial"
                                               type="text" placeholder="Telefone fixo"
                                               data-ng-required="!cadastroController.formCadastro.FoneCelular"
                                               data-ui-mask-placeholder data-ui-mask="99999999"
                                               data-ui-mask-placeholder-char="space"
                                               data-ng-model="cadastroController.formCadastro.telefoneFixo">
                                    </div>
                                </div>
                            </label>
                        </div>


                        <div class="col-xs-12 col-sm-4">
                            <label class="label_cadastro">E-MAIL
                                <input class="input_cadastro" type="email" name="email" placeholder="E-mail"
                                       data-ng-model="cadastroController.formCadastro.email"/>
                            </label>
                        </div>

                        <div class="col-xs-4">
                            <label class="label_cadastro">UF
                                <div class="wrap_form">
                                    <select name="estado" required
                                            data-ng-model="cadastroController.formCadastro.UFConsumidor"
                                            data-ng-change="cadastroController.buscarCidades()">
                                        <option value="" checked="checked">UF</option>
                                        <option value="AC">AC</option>
                                        <option value="AL">AL</option>
                                        <option value="AM">AM</option>
                                        <option value="AP">AP</option>
                                        <option value="BA">BA</option>
                                        <option value="CE">CE</option>
                                        <option value="DF">DF</option>
                                        <option value="ES">ES</option>
                                        <option value="GO">GO</option>
                                        <option value="MA">MA</option>
                                        <option value="MT">MT</option>
                                        <option value="MS">MS</option>
                                        <option value="MG">MG</option>
                                        <option value="PA">PA</option>
                                        <option value="PB">PB</option>
                                        <option value="PR">PR</option>
                                        <option value="PE">PE</option>
                                        <option value="PI">PI</option>
                                        <option value="RJ">RJ</option>
                                        <option value="RN">RN</option>
                                        <option value="RO">RO</option>
                                        <option value="RS">RS</option>
                                        <option value="RR">RR</option>
                                        <option value="SC">SC</option>
                                        <option value="SE">SE</option>
                                        <option value="SP">SP</option>
                                        <option value="TO">TO</option>
                                    </select>
                                </div>
                            </label>
                        </div>

                        <div class="col-xs-8">
                            <label class="label_cadastro">CIDADE
                                <div class="wrap_form">
                                    <select name="Cidade"
                                            ng-options="cidade.cidade as cidade.cidade for cidade in cadastroController.cidades"
                                            data-ng-model="cadastroController.formCadastro.CidadeConsumidor" required>
                                        <option value="" checked="checked">* CIDADE</option>
                                    </select>
                                </div>
                            </label>
                        </div>
                    </form>
                </div>


                <div data-ng-show="cadastroController.formCadastro.fase3">

                    <div class="col-xs-12">
                        <hr class="separador_cadastro4"/>
                    </div>

                    <form name="formCadastro">

                        <div class="col-xs-12">
                            <p class="atencao_cadastro azul">ATENÇÃO</p>
                            <p class="atencao_cadastro_sub cinza">
                                Para medicamentos de uso controlado é necessário incluir o CRM do médico que
                                o prescreveu. </p>

                        </div>

                        <div class="col-xs-12">
                            <div data-ng-show="!cadastroController.listaProduto">
                                Carregando produtos...
                            </div>
                        </div>

                        <div class="col-xs-12">

                            <div data-ng-show="cadastroController.requestProdutoInProgress">
                                Carregando produtos
                                <md-progress-linear md-mode="indeterminate"></md-progress-linear>
                            </div>

                            <label class="label_cadastro" data-ng-show="cadastroController.listaProduto">SELECIONE
                                UM PRODUTO
                                <div class="wrap_form">
                                    <select name="Produto" required
                                            data-ng-options="produto as produto.produto.apresentacao.toUpperCase() for produto in cadastroController.listaProduto  | orderBy:'produto.apresentacao' | uppercase"
                                            data-ng-model="cadastroController.formCadastro.produto">
                                        <option value="">* Selecione o Produto</option>
                                    </select>
                                </div>
                            </label>
                        </div>

                        <div class="tit_group col-xs-12">
                            DADOS DO MÉDICO
                            <span data-ng-show="cadastroController.formCadastro.produto.produto.requerPrescricao === 'F'"> (Opcional)</span>
                        </div>

                        <div class="col-xs-12 col-sm-4">
                            <label class="label_cadastro">ESTADO</label>
                            <div class="wrap_form">
                                <select name="estado"
                                        data-ng-required="cadastroController.formCadastro.produto.produto.requerPrescricao === 'T'"
                                        data-ng-model="cadastroController.formCadastro.UFProfissional">
                                    <option value="">Estado</option>
                                    <option value="AC">AC</option>
                                    <option value="AL">AL</option>
                                    <option value="AM">AM</option>
                                    <option value="AP">AP</option>
                                    <option value="BA">BA</option>
                                    <option value="CE">CE</option>
                                    <option value="DF">DF</option>
                                    <option value="ES">ES</option>
                                    <option value="GO">GO</option>
                                    <option value="MA">MA</option>
                                    <option value="MT">MT</option>
                                    <option value="MS">MS</option>
                                    <option value="MG">MG</option>
                                    <option value="PA">PA</option>
                                    <option value="PB">PB</option>
                                    <option value="PR">PR</option>
                                    <option value="PE">PE</option>
                                    <option value="PI">PI</option>
                                    <option value="RJ">RJ</option>
                                    <option value="RN">RN</option>
                                    <option value="RO">RO</option>
                                    <option value="RS">RS</option>
                                    <option value="RR">RR</option>
                                    <option value="SC">SC</option>
                                    <option value="SE">SE</option>
                                    <option value="SP">SP</option>
                                    <option value="TO">TO</option>
                                </select>
                            </div>
                        </div>

                        <label class="label_cadastro col-xs-12 col-sm-6">CRM
                            <span class="text-underline"
                                  data-ng-show="!cadastroController.buscaMedicoPeloNome && cadastroController.formCadastro.UFProfissional"
                                  data-ng-click="cadastroController.buscaMedicoPeloNome = true">[Buscar pelo nome]</span>
                            <span class="containerInputs">
                                                <input class="input_cadastro" type="text" disabled value="52"
                                                       data-ng-show="cadastroController.formCadastro.UFProfissional == 'RJ'"/>
                                                <input class="input_cadastro"
                                                       data-ng-class="{'crmContRio' : cadastroController.formCadastro.UFProfissional == 'RJ'}"
                                                       type="text" placeholder="CRM"
                                                       data-ng-disabled="!cadastroController.formCadastro.UFProfissional"
                                                       data-ng-required="cadastroController.formCadastro.produto.produto.requerPrescricao === 'T'"
                                                       data-ng-readonly="cadastroController.buscaMedicoPeloNome"
                                                       data-ng-model="cadastroController.formCadastro.codigoProfissional"/>
                                            </span>
                        </label>

                        <button class="btn-button btn-buscar-crm radius col-xs-12 col-sm-2" type="button"
                                data-ng-hide="cadastroController.buscaMedicoPeloNome"
                                data-ng-disabled="cadastroController.requestBuscaCRM || !cadastroController.formCadastro.codigoProfissional"
                                data-ng-click="cadastroController.buscarCrmV2(cadastroController.formCadastro)">
                            Buscar
                        </button>

                        <div class="row col-xs-12" data-ng-if="cadastroController.formCadastro.UFProfissional=='RJ' && !cadastroController.buscaMedicoPeloNome">
                            * Todos os CRMs do RJ começam com 52. Preencha apenas os números seguintes.
                        </div>

                        <div class="col-xs-12" data-ng-if="cadastroController.requestBuscaCRM && !cadastroController.buscaMedicoPeloNome">
                            Pesquisando CRM
                            <md-progress-linear md-mode="indeterminate"></md-progress-linear>
                        </div>

                        <div class="nomemedico fullMedico col-xs-12" data-ng-show="cadastroController.buscaMedicoPeloNome">
                            <label class="label_cadastro text-uppercase">NOME DO MÉDICO

                                <span class="crm naoseicrm text-underline"
                                      data-ng-show="cadastroController.buscaMedicoPeloNome && cadastroController.formCadastro.UFProfissional"
                                      data-ng-click="cadastroController.buscaMedicoPeloNome = false">
                                            [Buscar pelo número do CRM]</span>

                                <ui-select data-ng-model="cadastroController.dadosDoMedico" theme="bootstrap"
                                           style="width:100%"
                                           data-placeholder-text-single="'Digite o nome do Médico'"
                                           allow-single-deselect="true" reset-search-input="false"
                                           data-ng-model-options="{debounce: 1000}"
                                           data-ng-change="cadastroController.selecionarCrmV1(cadastroController.formCadastro, $select.selected.CodigoProfissional, $select.selected.NomeProfissional)"
                                           title="Digite o nome do Médico" on-select="">
                                    <ui-select-match placeholder="Digite o nome do médico" class="text-uppercase">
                                        {{$select.selected.NomeProfissional ? $select.selected.NomeProfissional
                                        + '
                                        - CRM: ' + $select.selected.CodigoProfissional + ' - UF: ' +
                                        $select.selected.UFProfissional : 'Digite o nome do médico'}}
                                    </ui-select-match>
                                    <ui-select-choices
                                            repeat="item in cadastroController.listaCrm | filter: $select.search " class="text-uppercase"
                                            refresh="cadastroController.findCrmByUfAndNomeProfissionalV1(cadastroController.formCadastro.UFProfissional, $select.search)"
                                            refresh-delay="100">
                                        <span style="text-transform: uppercase" class="text-uppercase" data-ng-bind-html="item.NomeProfissional | highlight: $select.search"></span>
                                        <small style="text-transform: uppercase" class="text-uppercase" ng-bind-html="' - CRM: ' + item.CodigoProfissional + ' - UF: ' + item.UFProfissional | highlight: $select.search"></small>
                                    </ui-select-choices>
                                </ui-select>
                            </label>
                        </div>

                        <div class="col-xs-12" data-ng-if="!cadastroController.listaCrm && cadastroController.requestBuscaCRM && cadastroController.buscaMedicoPeloNome">
                            Carregando médicos
                            <md-progress-linear md-mode="indeterminate"></md-progress-linear>
                        </div>

                        <div class="col-xs-12 row"
                             data-ng-show="cadastroController.formCadastro.nomeProfissional && !cadastroController.buscaMedicoPeloNome">
                            MÉDICO: <strong>{{cadastroController.formCadastro.nomeProfissional | uppercase}}</strong>
                        </div>


                        <!-- MENSAGENS DE ERRO -->
                        <ul class="mensagens_erro erros" style="color:red">
                            <li class="error" data-ng-if="formCadastroConclusao.nome.$error.required">- Preencha o nome </li>
                            <li class="error" ng-if="formCadastroConclusao.sobrenome.$error.required">- Preencha o sobrenome </li>
                            <li class="error" ng-if="formCadastroConclusao.sexo.$error.required">- Selecione o gênero </li>
                            <li class="error" data-ng-if="formCadastroConclusao.telefoneFixo.$error.required && formCadastroConclusao.FoneCelular.$error.required">- Preencha o telefone fixo ou telefone celular</li>
                            <li class="error" data-ng-if="formCadastroConclusao.estado.$error.required">- Selecione a UF </lidiv>
                            <li class="error" ng-if="formCadastroConclusao.Cidade.$error.required">- Selecione a cidade </li>

                            
                            
                            <!-- <li class="error" ng-if="cadastroController.formCadastro.produto.produto == '' || !cadastroController.formCadastro.produto.produto">- Selecione um produto </li> -->
                            <li class="error" ng-if="!cadastroController.formCadastro.produto.produto || cadastroController.formCadastro.produto.produto == '?'">- Selecione um produto </li>


                            <li class="error" ng-if="cadastroController.formCadastro.produto.produto.requerPrescricao === 'T' && !cadastroController.formCadastro.UFProfissional || (cadastroController.formCadastro.codigoProfissional && !cadastroController.formCadastro.UFProfissional)">- Preencha a UF do Médico </li>
                            <li class="error" ng-if="cadastroController.formCadastro.produto.produto.requerPrescricao === 'T' && !cadastroController.formCadastro.codigoProfissional || (cadastroController.formCadastro.UFProfissional && !cadastroController.formCadastro.codigoProfissional )">- Preencha o CRM do Médico</li>
                            
                            <!-- <li class="error" ng-if="cadastroController.formCadastro.produto.produto.requerPrescricao === 'T'">- Selecione um produto </li> -->

                            <br>
                        </ul>





                        <div class="col-xs-12">
                            <hr class="separador_cadastro4"/>
                        </div>

                        <div class="col-xs-12">

                            <div class="col-xs-2">
                                <md-progress-circular class="progress_loading md-accent md-hue-1" md-diameter="30"
                                                      md-mode="indeterminate"
                                                      data-ng-show="cadastroController.requestInProgress"></md-progress-circular>
                            </div>

                            <div class="button col-xs-10">

                                <!-- <button class="btn_cadastro_paciente radius" type="submit"
                                        data-ng-disabled="cadastroController.requestInProgress || formCadastro.$invalid"
                                        data-ng-click="cadastroController.salvarCadastro()">CONCLUIR
                                </button> -->
                                <button class="btn_cadastro_paciente radius" type="submit"
                                        data-ng-disabled="cadastroController.requestInProgress || formCadastro.$invalid || (cadastroController.formCadastro.produto.produto.requerPrescricao === 'F' && (cadastroController.formCadastro.UFProfissional && !cadastroController.formCadastro.codigoProfissional)) || (cadastroController.formCadastro.produto.produto.requerPrescricao === 'F' && (!cadastroController.formCadastro.UFProfissional && cadastroController.formCadastro.codigoProfissional)) || cadastroController.formCadastro.fase2 && (!cadastroController.formCadastro.NomeConsumidor || !cadastroController.formCadastro.SobrenomeConsumidor || !cadastroController.formCadastro.genero || !cadastroController.formCadastro.UFConsumidor || !cadastroController.formCadastro.CidadeConsumidor || (!cadastroController.formCadastro.telefoneFixo && !cadastroController.formCadastro.FoneCelular))"
                                        data-ng-click="cadastroController.consultaDadosCadastro()">CONCLUIR
                                </button>

                            </div>

                        </div>

                    </form>
                </div>
            </div>


        </div>


    </div>

</div>
